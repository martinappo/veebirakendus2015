{"version":3,"sources":["trainings.page.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"trainings.min.js","sourcesContent":["// ============== SEARCHING\r\n\r\nif ($('#search-trainings').length){\r\n\t$('body').on('click', '#search-trainings', function(event){\r\n\t\tstartLoading();\r\n\t\tevent.preventDefault();\r\n\t\tjQuery.ajax({\r\n\t\t\ttype: $('#search-form').attr('method'),\r\n\t\t\turl: $('#search-form').attr('action'),\r\n\t\t\tdata: {\r\n\t\t\t\t_token: $('input[name=\"_token\"]').val(),\r\n\t\t\t\ttag_list: $('#tag_list').val(),\r\n\t\t\t\twhat: $('#what').val(),\r\n\t\t\t\tdirection: $('#direction').val(),\r\n\t\t\t\tlatitude: $('#latitude').val(),\r\n\t\t\t\tlongitude: $('#longitude').val(),\r\n\t\t\t\tradius: $('#radius').val()\r\n\t\t\t},\r\n\t\t\tsuccess: function(data) {\r\n\t\t\t\tstopLoading();\r\n\t\t\t\t$('#search-results').html(data);\r\n\t\t\t},\r\n\t\t\terror: function(data) {\r\n\t\t\t\tstopLoading();\r\n\t\t\t\tconsole.error('Error in searching trainings');\r\n\t\t\t\tconsole.log(data.responseJSON);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\n// ==== RATING\r\nif ($('.rate').length){\r\n\t$('body').on('click', '.rate', function(event){\r\n\t\tstartLoading();\r\n\t\tevent.preventDefault();\r\n\t\tvar trainingId = $(this).attr('id');\r\n\r\n\t\tjQuery.ajax({\r\n\t\t\ttype: 'POST',\r\n\t\t\turl: 'rate/' + trainingId,\r\n\t\t\tdata: {\r\n\t\t\t\t_token: $('input[name=\"_token\"]').val(),\r\n\t\t\t\tvalue: $(this).html()\r\n\t\t\t},\r\n\t\t\tsuccess: function(data) {\r\n\t\t\t\tstopLoading();\r\n\t\t\t\t$('#rate-' + trainingId).html(data);\r\n\t\t\t},\r\n\t\t\terror: function(data) {\r\n\t\t\t\tstopLoading();\r\n\t\t\t\tconsole.error('Error in rating a training');\r\n\t\t\t\tconsole.log(data.responseJSON);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\n// === COMMENTING\r\n\r\nif ($('.add-comment').length){\r\n\t$('body').on('click', '.add-comment', function(event){\r\n\t\tstartLoading();\r\n\t\tevent.preventDefault();\r\n\t\tvar trainingId = $(this).attr('training');\r\n\t\tvar content = $('#comment-' + trainingId).val();\r\n\r\n\t\tjQuery.ajax({\r\n\t\t\ttype: 'POST',\r\n\t\t\turl: 'comments',\r\n\t\t\tdata: {\r\n\t\t\t\t_token: $('input[name=\"_token\"]').val(),\r\n\t\t\t\tcontent: content,\r\n\t\t\t\ttrainingId: trainingId\r\n\t\t\t},\r\n\t\t\tsuccess: function(data) {\r\n\t\t\t\tstopLoading();\r\n\t\t\t\t$('#comment-' + trainingId).val('');\r\n\t\t\t\t$('#' + trainingId + ' .comments').html(data);\r\n\t\t\t\tconsole.log('comment added');\r\n\t\t\t},\r\n\t\t\terror: function(data) {\r\n\t\t\t\tstopLoading();\r\n\t\t\t\tconsole.error('Error in commenting a training');\r\n\t\t\t\tconsole.log(data.responseJSON);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\nif ($('.delete-comment').length){\r\n\t$('body').on('click', '.delete-comment', function(event){\r\n\t\tstartLoading();\r\n\t\tevent.preventDefault();\r\n\t\tvar commentId = $(this).attr('commentid');\r\n\r\n\t\tjQuery.ajax({\r\n\t\t\ttype: 'DELETE',\r\n\t\t\turl: 'comments/' + commentId,\r\n\t\t\tdata: {\r\n\t\t\t\t_token: $('input[name=\"_token\"]').val(),\r\n\t\t\t},\r\n\t\t\tsuccess: function(data) {\r\n\t\t\t\tstopLoading();\r\n\t\t\t\t$('#comment-' + commentId).remove();\r\n\t\t\t\tconsole.log('comment deleted');\r\n\t\t\t},\r\n\t\t\terror: function(data) {\r\n\t\t\t\tstopLoading();\r\n\t\t\t\tconsole.error('Error in deleting a comment');\r\n\t\t\t\tconsole.log(data.responseJSON);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n}\r\n\r\n// ========================== MAP\r\n\r\nvar map;\r\nvar marker;\r\nvar latitudeInput = $ ( \"input#latitude\" );\r\nvar longitudeInput = $ ( \"input#longitude\" );\r\n\r\nfunction initialize() {\r\n\tconsole.log($('#map-container-search').length != 0);\r\n\tvar estonia = new google.maps.LatLng(58.886, 25.547);\r\n\t//Set coordinates input\r\n\tlatitudeInput.val(estonia.A);\r\n\tlongitudeInput.val(estonia.F);\r\n\t//Map itself\r\n\tvar mapOptions = {\r\n\t\tcenter: estonia,\r\n\t\tzoom: 8\r\n\t};\r\n\r\n\tmap = new google.maps.Map(document.getElementById('map-container-search'), mapOptions);\r\n\r\n\tgetTrainings();\r\n\r\n\t//Add listener for choosing place from map\r\n\tgoogle.maps.event.addListener(map, 'click', function(event) {\r\n\t\tplaceMarkerForSearching(event.latLng);\r\n\t});\r\n}\r\n\r\nfunction getTrainings() {\r\n\tjQuery.ajax({\r\n\t\ttype: 'GET',\r\n\t\turl: 'trainings/map',\r\n\t\tsuccess: function(data) {\r\n\t\t\tpopulateTrainings(data);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction populateTrainings(trainings) {\r\n\tfor (var i = 0, training; training = trainings[i]; i++) {\r\n\t\tplaceMarker(training);\r\n\t}\r\n}\r\n\r\nfunction placeMarker(training) {\r\n\t//Parse coordinates\r\n\tvar coordinatesLatLng = new google.maps.LatLng(training.latitude, training.longitude);\r\n\r\n\t//Info window\r\n\tvar infoContent = '<h5>'+training.title+'</h5>'+\r\n\t\t'<p>'+training.description+'</p>';\r\n\tvar infoWindow = new google.maps.InfoWindow({\r\n\t\tcontent: infoContent,\r\n\t})\r\n\r\n\t//Adding marker\r\n\tvar marker = new google.maps.Marker({\r\n\t\tposition: coordinatesLatLng,\r\n\t\tmap: map,\r\n\t\ttitle: training.title\r\n\t});\r\n\r\n\t//Listener to marker\r\n\tgoogle.maps.event.addListener(marker, 'click', function() {\r\n\t\tinfoWindow.open(map,marker);\r\n\t});\r\n}\r\n\r\nfunction placeMarkerForSearching(location) {\r\n\t//Remove last marker\r\n\tif (marker) {\r\n\t\tmarker.setMap(null);\r\n\t}\r\n\r\n\t//Adding marker\r\n\tmarker = new google.maps.Marker({\r\n\t\tposition: location,\r\n\t\tmap: map,\r\n\t});\r\n\r\n\t//Set coordinates input\r\n\tlatitudeInput.val(location.A);\r\n\tlongitudeInput.val(location.F);\r\n\r\n}\r\n\r\nfunction loadScript() {\r\n\tvar script = document.createElement('script');\r\n\tscript.type = 'text/javascript';\r\n\tscript.src = 'https://maps.googleapis.com/maps/api/js?v=3.exp?key=AIzaSyDkK8oL9mzyASA_lqgYYDleQDjVZLOonOY' + '&signed_in=true&callback=initialize';\r\n\tdocument.body.appendChild(script);\r\n}\r\nwindow.onload = loadScript;\r\n"],"sourceRoot":"/source/"}